# チャレンジ1: **SQLとPython**

## **背景と目的**

このチャレンジの目的は、PythonコードでSQLクエリを使用し、プログラミングでデータベースを操作するスキルを磨くことです。

## **データ**

このチャレンジでは **`chinook.db`** データベースを使用します。 

Pythonの組み込みライブラリ **`sqlite3`** を使用して **`chinook.db`** データベースに接続し、操作します。

IPythonまたはPythonスクリプトで **`chinook.db`** データベースに接続するには、チャレンジのディレクトリで次のコードを実行します。

```python
import sqlite3

conn = sqlite3.connect('data/chinook.db')
db = conn.cursor()
db.execute("YOUR SQL QUERY")
rows = db.fetchall()
print(rows)  # => タプル (列) のリスト (行)
```

まず、DBeaverを使用して **`data/chinook.db`** データベースに接続し、SQLクエリを作成してテストします。次に、これらのクエリをPythonコードに組み込みます。

**`queries.py`** ファイルの各関数には、データベースに接続した **`db`** カーソルを渡します。関数のテンプレートは次のようになります。

```python
def your_function(db):
    query = ""
    db.execute(query)
    results = db.fetchall()
    print(results)  # 結果を確認する
    return ?
```

目的のデータを適切に取得するために、リスト、タプルなどのデータ構造から必要に応じて要素を取得してください。整数を想定している場合に別のデータ型を返さないようにします。

### **アーティストの数**

データベースには何組のアーティストが登録されていますか。

### **アーティストのリスト**

すべてのアーティスト名をアルファベット順で並べ替えて、名前 (文字列) のリストを返してください。

### **「愛」をテーマにしたアルバムのリスト**

タイトルに単語「love」を含むアルバムを取得し、アルファベット順に並べ替えたアルバムのタイトルを返してください。

### **指定した時間より長い楽曲の数**

ユーザーが指定した再生時間よりも長い楽曲はいくつありますか。

### **最も楽曲数が多いジャンルのリスト**

最も楽曲数が多いジャンルはどれですか。ジャンル名を楽曲数の降順で並べ替えたリストを返してください。

## **ヒント**

👉 SQLクエリをSQLインジェクションから保護するには、パラメータ置換を使用します。

👉 SQLクエリが長い場合、Pythonの三重引用符を使用して文字列を複数行で記述します。

```python
query = """
    SELECT name
    FROM artists
    WHERE name LIKE "%love%"
    ORDER BY name
"""
rows = db.execute(query)
# [...]
```